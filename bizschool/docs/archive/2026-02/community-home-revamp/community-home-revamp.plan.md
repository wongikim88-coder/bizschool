# Plan: 커뮤니티 홈 리뉴얼 (community-home-revamp)

> Feature: 커뮤니티 홈 탭을 섹션별 리스트에서 인기 게시글 통합 피드 + 무한 스크롤 방식으로 변경
> Created: 2026-02-27
> Status: Plan
> Reference: https://www.inflearn.com/community

---

## 1. 배경 및 목적

### 1.1 현재 상태
- 커뮤니티 홈 탭이 **섹션별 분리**(인기 강의질문 5개, 인기 상담사례 5개, 인기 소통공간 5개)로 구성됨
- 각 섹션은 별도의 `Section` 컴포넌트로 감싸져 있고, 더보기 링크로 해당 탭으로 이동
- 우측에 WeeklyTopUsers 사이드바 존재
- 기존 탭별 페이지(강의질문/상담사례/소통공간)는 페이지네이션 방식

### 1.2 변경 목적
- 인프런 커뮤니티 첫 화면처럼 **모든 카테고리의 인기 게시글을 한 피드에 섞어서** 표시
- **무한 스크롤**로 스크롤을 내리면 추가 게시물이 계속 로딩
- 사용자가 섹션 구분 없이 인기 콘텐츠를 자연스럽게 탐색할 수 있도록 개선

---

## 2. 요구사항

### 2.1 핵심 요구사항 (Must Have)

| # | 요구사항 | 설명 |
|---|---------|------|
| R1 | 통합 인기 피드 | 강의질문/상담사례/소통공간 모든 게시글을 인기순(viewCount)으로 통합 정렬 후 셔플링 표시 |
| R2 | 무한 스크롤 | 스크롤을 내리면 추가 게시물이 자동 로드됨 (10개씩) |
| R3 | 카테고리 태그 | 각 게시물 카드에 어떤 카테고리(강의질문/상담사례/소통공간)인지 태그로 표시 |
| R4 | 인프런 스타일 레이아웃 | 단일 컬럼 피드 형태, 게시물 간 구분선, 본문 미리보기 표시 |

### 2.2 유지 사항 (Keep)

| # | 유지 항목 | 설명 |
|---|----------|------|
| K1 | CommunityTabs | 홈/강의질문/상담사례/소통공간 탭 네비게이션 유지 |
| K2 | WeeklyTopUsers | 우측 사이드바(데스크톱), 하단 가로스크롤(모바일) 유지 |
| K3 | 탭별 페이지 | 강의질문/상담사례/소통공간 각 탭의 기존 페이지네이션 방식 유지 |
| K4 | PostCard 타입별 메타정보 | 질문/상담/소통 각 타입별 메타 정보 렌더링 유지 |

### 2.3 변경 범위

| 영향받는 파일 | 변경 내용 |
|-------------|----------|
| `HomeTab.tsx` | 전면 재작성 (섹션별 → 통합 피드 + 무한 스크롤) |
| `PostCard.tsx` | 본문 미리보기 텍스트 추가, 카테고리 태그 색상 분화 |
| `community/page.tsx` | HomeTab이 Client Component로 변경될 수 있으므로 조정 |
| `data/community.ts` | 게시물에 `content` (본문 미리보기) 필드 추가, 통합 피드용 유틸 함수 |
| `types/index.ts` | CommunityPost 타입에 `content` 필드 추가 |

---

## 3. 기능 상세

### 3.1 통합 인기 피드

- 모든 카테고리(강의질문 15개 + 상담사례 15개 + 소통공간 15개 = 총 45개)의 게시물을 합침
- **정렬**: viewCount 기준 내림차순
- **셔플링**: 같은 카테고리가 연속으로 나오지 않도록 적절히 섞어서 배치
  - 알고리즘: viewCount로 정렬 후, 상위 N개를 가져온 뒤 인접한 같은 카테고리가 없도록 재배치
- **초기 로드**: 10개 게시물 표시
- **추가 로드**: 스크롤 시 10개씩 추가 (최대 45개까지)

### 3.2 무한 스크롤

- `IntersectionObserver` API를 사용한 무한 스크롤 구현
- 하단 감지 요소(sentinel)에 도달하면 다음 배치 로드
- **로딩 인디케이터**: 추가 로드 중 스피너 표시
- **끝 표시**: 모든 게시물을 로드한 뒤 "모든 게시물을 확인했습니다" 메시지
- Mock 데이터이므로 실제 API 호출 없이 클라이언트 사이드에서 슬라이싱 처리

### 3.3 게시물 카드 (인프런 스타일)

인프런 레퍼런스 기반 카드 구조:
```
┌──────────────────────────────────────────────────────┐
│ [카테고리태그]                                          │
│ 게시물 제목 (굵게, 큰 텍스트)                            │
│ 본문 미리보기 텍스트 (2줄, 회색)                         │
│ 작성자 · 시간 전                                       │
├──────────────────────────────────────────────────────┤
│ (다음 게시물...)                                        │
```

- 카테고리 태그: 색상으로 구분
  - 강의질문: 파란색 계열
  - 상담사례: 녹색 계열
  - 소통공간: 보라색 계열
- 제목: 기존보다 큰 텍스트 (`text-base font-bold`)
- 본문 미리보기: 새로 추가, 2줄 제한 (`line-clamp-2`)
- 메타 정보: `작성자 · N분 전` 형태로 간소화
- 게시물 간 구분선 (`<hr>` 또는 `divide-y`)

### 3.4 레이아웃 구조

**데스크톱 (>= 1024px)**:
```
┌───────────────────────────────────┬────────────────────┐
│ 통합 인기 피드 (flex-1)            │ 주간 TOP 10 (280px) │
│                                   │                    │
│ [카드] [카드] [카드] ...           │ (sticky sidebar)   │
│         무한 스크롤               │                    │
└───────────────────────────────────┴────────────────────┘
```

**모바일/태블릿 (< 1024px)**:
```
┌───────────────────────────────────┐
│ 통합 인기 피드                     │
│ [카드] [카드] [카드] ...           │
│         무한 스크롤               │
├───────────────────────────────────┤
│ 주간 TOP 10 (가로 스크롤)          │
└───────────────────────────────────┘
```

---

## 4. 기술적 고려사항

### 4.1 Client Component 전환
- HomeTab은 `IntersectionObserver`와 `useState`를 사용하므로 Client Component(`"use client"`)로 변경
- 기존 Server Component에서 Client Component로 전환

### 4.2 셔플링 알고리즘
- viewCount 내림차순 정렬 후, 같은 타입이 연속하지 않도록 인터리빙
- 간단한 round-robin 방식: 각 타입별 큐에서 번갈아 가져오기 (인기순 유지)

### 4.3 성능 고려
- Mock 데이터 45개로 한정되므로 성능 이슈 없음
- 실제 API 연동 시에는 서버 사이드 페이지네이션 + cursor 기반 방식 권장

### 4.4 Tailwind CSS v4 주의
- 모든 CSS custom property는 `var()` 래퍼 필수
- `bg-[var(--color-primary)]` (O) / `bg-[--color-primary]` (X)

---

## 5. 구현 순서

| # | 작업 | 파일 | 설명 |
|---|-----|------|------|
| 1 | 타입 수정 | `types/index.ts` | CommunityPost에 `content` 필드 추가 |
| 2 | Mock 데이터 수정 | `data/community.ts` | 각 게시물에 `content` 필드 추가 + 통합 피드 유틸 함수 |
| 3 | PostCard 수정 | `PostCard.tsx` | 피드용 카드 레이아웃 추가 (본문 미리보기, 카테고리 색상 분화) |
| 4 | HomeTab 재작성 | `HomeTab.tsx` | 통합 피드 + 무한 스크롤 구현 (Client Component) |
| 5 | page.tsx 조정 | `community/page.tsx` | HomeTab 변경에 따른 import/props 조정 |

---

## 6. 비영향 범위 (Out of Scope)

- 강의질문/상담사례/소통공간 각 탭의 기존 레이아웃 (변경 없음)
- CommunityTabs 컴포넌트 (변경 없음)
- WeeklyTopUsers 컴포넌트 (변경 없음)
- CommunityPagination 컴포넌트 (변경 없음)
- 실제 백엔드 API 연동 (Mock 데이터 기반)
- 게시물 상세 페이지

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | 2026-02-27 | Initial draft | Claude |
